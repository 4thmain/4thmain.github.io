<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>
    Bus tracker - Touring Talkies
  </title>
  <link href="vendor/foundation-4/css/foundation.css" media="all" rel="stylesheet"
  type="text/css" />
  <link href="css/live-bus-tracker.css" media="all" rel="stylesheet" type="text/css"
  />
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>
  <script src="vendor/foundation-4/js/vendor/custom.modernizr.js"></script>
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.3/leaflet.css" />
<!--[if lte IE 8]>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.3/leaflet.ie.css" />
    <![endif]-->

    <script src="http://cdn.leafletjs.com/leaflet-0.6.3/leaflet.js"></script>

  </head>

  <body>
    <div id="info">
    <div id="status">
          <h3>Speed: 60 kmph</h3>
          <h4>Scheduled Arrival: 06:30</h4>
        </div>
        <h1>Hyderabad <small>to</small> Nagpur<div class="subheader">Neeta Volvo</div></h1>
        
    </div>
    <div id="map">
    </div>
    <script src="vendor/jquery.js"></script>
    <script src="vendor/foundation-4/js/foundation.min.js"></script>
    <script>

      $(document).ready(function() {
        $(document).foundation(); 

        var map = L.map('map').setView([17.36, 78.47], 9);

        L.tileLayer('img/osm-india-clear-map/{z}/{x}/{y}.png', {
          attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
          maxZoom: 13
        }).addTo(map);

        var bus;

        function update_position() {
          $.getJSON('img/live-bus-tracker-route1.geojson', function(data) {
            console.log(data);
            var latitude = data["features"]["iss_position"]["latitude"];
            var longitude = data["features"]["iss_position"]["longitude"];
            if (!bus) {
              bus = L.marker([latitude,longitude]).bindPopup("Speed: 60kmph").addTo(map);
            }
            bus.setLatLng([latitude,longitude]).update();
            setTimeout(update_position, 1000);
          });
        }

        update_position();


      });



</script>

</body>

</html>